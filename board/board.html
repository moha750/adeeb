<!doctype html>
<html dir="rtl" lang="ar">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>سبورة أدِيب — أفكار واقتراحات</title>
    <!-- Primary SEO -->
    <meta name="description" content="سبورة أدِيب: مساحة عامة لمشاركة الأفكار والاقتراحات والإبداعات مع مجتمع النادي." />
    <meta name="robots" content="index, follow" />
    <meta name="theme-color" content="#274060" />
    <link rel="canonical" href="https://www.adeeb.club/board/board.html" />
    <!-- Open Graph -->
    <meta property="og:site_name" content="نادي أدِيب" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="ar_SA" />
    <meta property="og:title" content="سبورة أدِيب — أفكار واقتراحات" />
    <meta property="og:description" content="مساحة عامة لمشاركة الأفكار والاقتراحات والإبداعات مع مجتمع النادي." />
    <meta property="og:url" content="https://www.adeeb.club/board/board.html" />
    <meta property="og:image" content="https://www.adeeb.club/LOGO.png" />
    <meta property="og:image:alt" content="شعار نادي أدِيب" />
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@AB_KFU" />
    <meta name="twitter:title" content="سبورة أدِيب — أفكار واقتراحات" />
    <meta name="twitter:description" content="مساحة عامة لمشاركة الأفكار والاقتراحات والإبداعات مع مجتمع النادي." />
    <meta name="twitter:image" content="https://www.adeeb.club/LOGO.png" />
    <!-- JSON-LD: WebPage -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "سبورة أدِيب — أفكار واقتراحات",
        "url": "https://www.adeeb.club/board/board.html",
        "inLanguage": "ar"
      }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" />
    <link rel="stylesheet" href="../style.css" />
    <link rel="stylesheet" href="board.css" />
    <style>
      /* Topics grid and cards (embedded) */
      .topics-grid { display: grid; gap: 14px; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); align-items: start; }
      .topic-card { border:1px solid var(--border); border-radius: 14px; background:#fff; overflow:hidden; box-shadow: 0 6px 18px rgba(39,64,96,.06); transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease; cursor: pointer; }
      .topic-card:hover { transform: translateY(-3px); box-shadow: 0 12px 28px rgba(39,64,96,.12); }
      .topic-card .card-media {
        height: 190px;
        background: linear-gradient(135deg, rgba(61, 143, 214, .12), rgba(39, 64, 96, .08));
      }
      .card-media i {font-size: 4rem !important;}
      .topic-card .card-media img { width: 100%; height: 100%; object-fit: cover; display: block; }
      .topic-card .card-body { padding: 12px 14px; display: grid; gap: 6px; text-align: center; }
      .topic-card .title { font-family: fb, system-ui; color: var(--main-blue); font-size: 1.05rem; }
      .topic-card .desc { color: var(--muted); font-size: .9rem; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
      .topics-filter { display: flex; gap: 8px; flex-wrap: wrap; }
      .topics-filter .chip { cursor: pointer; }
      .topics-filter .chip.active { background: rgba(61,143,214,.10); border-color: rgba(61,143,214,.35); color: var(--main-blue); }
      @media (max-width: 640px) { .topics-grid { grid-template-columns: 1fr; } }
    </style>
  </head>
  <body class="board-body">
    <header class="board-header">
      <div class="container">
        <h1 class="board-title"><i class="fa-solid fa-lightbulb"></i> سبورة أدِيب</h1>
        <p class="board-sub">مساحة مفتوحة لمشاركة الأفكار والمقتراحات. كل ما يُنشر هنا ظاهر للجميع.</p>
        <div class="board-actions">
          <a class="btn btn-outline" href="../index.html"><i class="fa-solid fa-arrow-right"></i> رجوع للموقع</a>
        </div>
      </div>
    </header>

    <main class="board-main">
      <!-- Topics Landing -->
      <section id="topicsPanel" class="panel" style="padding:16px">
        <div style="display:flex;align-items:center;gap:8px; margin-bottom:10px">
          <h2 style="margin:0;font-size:rem;color:var(--main-blue)"><i class="fa-solid fa-book-open"></i> المواضيع</h2>
          <div style="flex:1"></div>
          <button id="topicsRefreshBtn" class="btn btn-outline"><i class="fa-solid fa-rotate"></i> تحديث</button>
        </div>
        <div id="topicsGrid" class="topics-grid" aria-live="polite"></div>
        <div id="topicsEmpty" class="empty-state muted" style="display:none">لا توجد مواضيع بعد.</div>
      </section>

      <section id="submitPanel" class="panel" style="padding:16px; display:none">
        <div style="display:flex;align-items:center;gap:8px; margin-bottom:10px">
          <button id="backToTopicsBtn" class="btn btn-outline" style="display:none"><i class="fa-solid fa-arrow-right"></i> كل المواضيع</button>
          <div id="currentTopicHeader" class="muted" style="display:none"></div>
        </div>
        <form id="ideaForm" class="form-grid" style="grid-template-columns: 1fr">
          <label>
            عنوان الفكرة
            <input id="ideaTitle" type="text" maxlength="120" placeholder="اكتب عنوانًا موجزًا للفكرة" />
            <small id="titleCharLeft" class="field-help">الحد الأقصى 120 حرف</small>
          </label>
          <label>
            الموضوع
            <select id="ideaTopicSelect" required></select>
            <small class="field-help">اختر موضوعًا لنشر فكرتك ضمنه</small>
          </label>
          <label>
            فكرتك أو اقتراحك
            <textarea id="ideaContent" rows="4" maxlength="500" placeholder="اكتب فكرتك هنا..." required></textarea>
            <small id="charLeft" class="field-help">الحد الأقصى 500 حرف</small>
          </label>
          <label>
            إرفاق صورة (اختياري)
            <input id="ideaImage" type="file" accept="image/*" />
            <small class="field-help">PNG/JPG حتى 3MB. ستظهر للجميع.</small>
          </label>
          <div id="imagePreview" class="img-preview" style="display:none">
            <img id="previewImg" alt="معاينة الصورة" />
            <button type="button" class="btn btn-outline btn-xs" id="clearImageBtn"><i class="fa-solid fa-xmark"></i> إزالة</button>
          </div>
          <label>
            أسمك
            <input id="ideaName" type="text" maxlength="80" placeholder="مثال: زائر، شهد، عبدالمحسن" required />
            <small class="field-help">الاسم مطلوب لحفظ حقوق الفكرة</small>
          </label>
          <div style="display:flex;gap:8px;align-items:center">
            <button type="submit" class="btn btn-primary"><i class="fa-solid fa-paper-plane"></i> نشر الفكرة</button>
            <span id="ideaMsg" class="muted" aria-live="polite"></span>
          </div>
        </form>
      </section>

      <section id="listPanel" class="panel" style="padding:16px; margin-top:16px; display:none">
        <div style="display:flex;align-items:center;gap:8px; margin-bottom:10px">
          <h2 style="margin:0;font-size:1rem;color:var(--main-blue)"><i class="fa-solid fa-chalkboard"></i> الأفكار المنشورة</h2>
          <div style="flex:1"></div>
          <button id="refreshBtn" class="btn btn-outline"><i class="fa-solid fa-rotate"></i> تحديث</button>
        </div>
        <div id="topicsFilter" class="topics-filter" style="display:none"></div>
        <div id="boardList" class="board-list" aria-live="polite"></div>
        <div id="emptyState" class="empty-state muted" style="display:none">لا توجد أفكار بعد. كن أول من يشارك فكرة!</div>
      </section>
    </main>
    
    <!-- Idea Modal -->
    <div id="ideaModal" class="modal" hidden>
      <div class="modal__backdrop" id="ideaModalBackdrop"></div>
      <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="ideaModalTitle">
        <div class="idea-modal">
          <div id="ideaModalHero" class="idea-hero">
            <!-- Filled dynamically: image/brand + time badge -->
            <button type="button" class="idea-modal__close btn btn-outline btn-xs" id="ideaModalClose" aria-label="إغلاق">
              <i class="fa-solid fa-xmark"></i>
            </button>
          </div>
          <div class="idea-modal__head">
            <h3 id="ideaModalTitle" class="idea-modal__title"></h3>
            <button class="like-btn" id="ideaModalLikeBtn" data-id="" aria-pressed="false" title="إعجاب">
              <i class="fa-regular fa-heart"></i>
              <span class="like-count">0</span>
            </button>
          </div>
          <div id="ideaModalMeta" class="idea-modal__meta"></div>
          <div id="ideaModalContent" class="idea-modal__content"></div>
          <div class="idea-modal__footer">
            <button class="btn btn-outline" id="ideaModalDownloadBtn" title="تحميل الصورة">
              <i class="fa-solid fa-download"></i> تحميل الصورة
            </button>
            <button class="btn btn-outline" id="ideaModalCopyLinkBtn" title="نسخ رابط الفكرة">
              <i class="fa-solid fa-link"></i> نسخ الرابط
            </button>
            <button class="btn btn-primary" id="ideaModalCopyBtn" title="نسخ الفكرة">
              <i class="fa-solid fa-copy"></i> نسخ الفكرة
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../supabase-config.js"></script>
    <script src="board.js"></script>
  </body>
  
</html>
