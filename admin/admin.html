<!doctype html>
<html dir="rtl" lang="ar">
    <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>لوحة تحكم — نادي أديب</title>
      <meta name="robots" content="noindex, nofollow" />
      <meta name="googlebot" content="noindex, nofollow" />
      <meta name="apple-mobile-web-app-capable" content="yes" />
      <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
      <meta name="apple-mobile-web-app-title" content="إدارة أدِيب" />
      <meta name="theme-color" content="#274060" />
      <link rel="canonical" href="https://www.adeeb.club/admin/admin.html" />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" />
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cropperjs@1.6.2/dist/cropper.min.css" />
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" />
      <link rel="stylesheet" href="../style.css?v=20251017" />
      <link rel="stylesheet" href="admin.css?v=20251017" />
      <link rel="manifest" href="manifest.webmanifest" />
      <link rel="apple-touch-icon" href="/admin/icons/icons/icon-512x512.png" />
    </head>
  <body class="admin-body" style="display:none">
    <header class="admin-header">
      <div class="admin-header__container">
        <div class="admin-header__actions">
          <button id="loginBtn" class="btn btn-outline"><i class="fa-solid fa-right-to-bracket"></i> تسجيل الدخول</button>
          <button id="toggleSidebar" class="btn btn-outline"><i class="fa-solid fa-chevron-left"></i></button>
          <div class="notif-wrap">
            <button id="notifBtn" class="btn btn-outline notif-btn" aria-haspopup="true" aria-expanded="false" aria-controls="notifDropdown" title="الإشعارات">
              <i class="fa-regular fa-bell"></i>
              <span id="notifBadge" class="notif-badge" style="display:none">0</span>
            </button>
            <div id="notifDropdown" class="notif-dropdown" hidden>
              <div class="notif-head">
                <div class="notif-title"><i class="fa-regular fa-bell"></i> الإشعارات</div>
                <div style="flex:1"></div>
                <button id="notifMarkAll" type="button" class="btn small"><i class="fa-regular fa-circle-check"></i> تعليم الكل كمقروء</button>
                <button id="notifClearAll" type="button" class="btn btn-outline small" title="مسح الكل"><i class="fa-regular fa-trash-can"></i></button>
              </div>
              <div id="notifList" class="notif-list" aria-live="polite"></div>
              <div id="notifEmpty" class="empty-state muted">لا يوجد إشعارات</div>
            </div>
          </div>
        </div>
        <div id="adminUserBadge" class="user-badge" aria-live="polite"></div>
      </div>
    </header>

    <div class="admin-layout">
      <aside id="sidebar" class="admin-sidebar">
        <div class="admin-sidebar__brand">
          <span>لوحة التحكم</span>
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
        <nav class="admin-menu">
          <a href="#section-stats" class="admin-menu__item"><i class="fa-solid fa-chart-column"></i> الإحصائيات</a>
          <a href="#section-home" class="admin-menu__item"><i class="fa-solid fa-sitemap"></i> إدارة الموقع</a>
          <a href="#section-blog" class="admin-menu__item"><i class="fa-solid fa-anchor"></i> إدارة مرافئ</a>
          <a href="#section-members" class="admin-menu__item"><i class="fa-solid fa-users-rectangle"></i> أعضاء النادي</a>
          <a href="#section-membership-apps" class="admin-menu__item"><i class="fa-solid fa-id-badge"></i> طلبات العضوية</a>
          <a href="#section-schedule" class="admin-menu__item"><i class="fa-solid fa-calendar-days"></i> جدول أدِيب</a>
          <a href="#section-appointments" class="admin-menu__item"><i class="fa-solid fa-calendar-check"></i> حجز المواعيد</a>
          <a href="#section-forms" class="admin-menu__item"><i class="fa-solid fa-list-check"></i> الاستبيانات</a>
          <a href="#section-idea-board" class="admin-menu__item"><i class="fa-solid fa-lightbulb"></i> سبورة أدِيب</a>
          <a href="#section-chat" class="admin-menu__item"><i class="fa-solid fa-comments"></i> المحادثات</a>
          <a href="#section-todos" class="admin-menu__item"><i class="fa-solid fa-list-check"></i> المهام</a>
          <a href="#section-push" class="admin-menu__item"><i class="fa-solid fa-bell"></i> إرسال الإشعارات</a>
          <a href="#section-profile" class="admin-menu__item active"><i class="fa-solid fa-id-card"></i> ملفي</a>
          <a href="#section-admins" class="admin-menu__item"><i class="fa-solid fa-user-shield"></i> إدارة الأعضاء الإداريين</a>
          <div class="admin-menu__footer">
            <button type="button" class="btn btn-outline" data-logout><i class="fa-solid fa-right-from-bracket"></i> تسجيل الخروج</button>
            <a class="btn btn-primary" href="../index.html" target="_blank"><i class="fa-solid fa-globe"></i> عرض الموقع</a>
          </div>
        </nav>
      </aside>

      <main class="admin-main">
        <section id="section-stats" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-chart-column"></i> الإحصائيات</h2>
          </div>
          <div class="cards-grid" id="statsGrid" aria-live="polite"></div>
        </section>
        <section id="section-home" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-sitemap"></i> إدارة الموقع</h2>
          </div>
          <div class="cards-grid">
            <div class="card">
              <div class="card__body">
                <div class="card__title"><i class="fa-solid fa-briefcase"></i> إدارة الأعمال</div>
                <p class="card__text" style="color:#64748b; line-height:1.6">إضافة وتعديل وحذف الأعمال مع الصورة والفئة والرابط الخارجي.</p>
                <div class="card__actions">
                  <button class="btn btn-primary" data-go="#section-works"><i class="fa-solid fa-arrow-left"></i> فتح</button>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card__body">
                <div class="card__title"><i class="fa-solid fa-handshake"></i> إدارة الرعاة</div>
                <p class="card__text" style="color:#64748b; line-height:1.6">إدارة الرعاة بإضافة الشعار والاسم والوسم والوصف ورابط الموقع.</p>
                <div class="card__actions">
                  <button class="btn btn-primary" data-go="#section-sponsors"><i class="fa-solid fa-arrow-left"></i> فتح</button>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card__body">
                <div class="card__title"><i class="fa-solid fa-trophy"></i> إدارة الإنجازات</div>
                <p class="card__text" style="color:#64748b; line-height:1.6">إنشاء أرقام إنجاز مع الأيقونة والترتيب وإظهار علامة + اختياريًا.</p>
                <div class="card__actions">
                  <button class="btn btn-primary" data-go="#section-achievements"><i class="fa-solid fa-arrow-left"></i> فتح</button>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card__body">
                <div class="card__title"><i class="fa-solid fa-list-check"></i> إدارة الاستبيانات</div>
                <p class="card__text" style="color:#64748b; line-height:1.6">إنشاء الاستبيانات ومتابعة الردود وإغلاقها.</p>
                <div class="card__actions">
                  <button class="btn btn-primary" data-go="#section-forms"><i class="fa-solid fa-arrow-left"></i> فتح</button>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card__body">
                <div class="card__title"><i class="fa-solid fa-users"></i> إدارة المجلس الإداري</div>
                <p class="card__text" style="color:#64748b; line-height:1.6">إضافة الأعضاء والمناصب وصورة العضو وروابط التواصل والبريد.</p>
                <div class="card__actions">
                  <button class="btn btn-primary" data-go="#section-board"><i class="fa-solid fa-arrow-left"></i> فتح</button>
                </div>
              </div>
            </div>
 
            <div class="card">
              <div class="card__body">
                <div class="card__title"><i class="fa-solid fa-user-plus"></i> زر "انضم إلينا"</div>
                <p class="card__text" style="color:#64748b; line-height:1.6">فتح/إغلاق زر الانضمام في الصفحة الرئيسية. عند الإغلاق سيظهر تنبيه بإغلاق التسجيل.</p>
                <div class="card__actions">
                  <button class="btn btn-primary" data-go="#section-join"><i class="fa-solid fa-arrow-left"></i> فتح</button>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card__body">
                <div class="card__title"><i class="fa-solid fa-question-circle"></i> إدارة الأسئلة الشائعة</div>
                <p class="card__text" style="color:#64748b; line-height:1.6">تنظيم الأسئلة مع الإجابات وتحديد ترتيب العرض.</p>
                <div class="card__actions">
                  <button class="btn btn-primary" data-go="#section-faq"><i class="fa-solid fa-arrow-left"></i> فتح</button>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card__body">
                <div class="card__title"><i class="fa-solid fa-star"></i> إدارة آراء الأعضاء</div>
                <p class="card__text" style="color:#64748b; line-height:1.6">إضافة وتعديل وحذف آراء الأعضاء وتحديد الظهور والتقييم.</p>
                <div class="card__actions">
                  <button class="btn btn-primary" data-go="#section-testimonials"><i class="fa-solid fa-arrow-left"></i> فتح</button>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card__body">
                <div class="card__title"><i class="fa-solid fa-anchor"></i> إدارة مرافئ (المدونة)</div>
                <p class="card__text" style="color:#64748b; line-height:1.6">إنشاء وتعديل وحذف تدوينات مرافئ مع الصورة والتاريخ والحالة.</p>
                <div class="card__actions">
                  <button class="btn btn-primary" data-go="#section-blog"><i class="fa-solid fa-arrow-left"></i> فتح</button>
                </div>
              </div>
            </div>
            <!-- removed schedule and todos home cards -->
          </div>
        </section>
        <section id="section-works" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-briefcase"></i> إدارة الأعمال</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button class="btn btn-outline" data-go="#section-home"><i class="fa-solid fa-arrow-right"></i> رجوع</button>
              <button id="addWorkBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة عمل</button>
            </div>
          </div>
          <div id="worksList" class="cards-grid" aria-live="polite"></div>
        </section>

        <section id="section-sponsors" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-handshake"></i> إدارة الرعاة</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button class="btn btn-outline" data-go="#section-home"><i class="fa-solid fa-arrow-right"></i> رجوع</button>
              <button id="addSponsorBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة راعٍ</button>
            </div>
          </div>
          <div id="sponsorsList" class="cards-grid" aria-live="polite"></div>
        </section>

        <section id="section-achievements" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-trophy"></i> إدارة الإنجازات</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button class="btn btn-outline" data-go="#section-home"><i class="fa-solid fa-arrow-right"></i> رجوع</button>
              <button id="addAchievementBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة إنجاز</button>
            </div>
          </div>
          <div id="achievementsList" class="cards-grid" aria-live="polite"></div>
        </section>

        <section id="section-board" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-users"></i> إدارة المجلس الإداري</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button class="btn btn-outline" data-go="#section-home"><i class="fa-solid fa-arrow-right"></i> رجوع</button>
              <button id="addBoardBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة عضو</button>
            </div>
          </div>
          <div id="boardList" class="cards-grid" aria-live="polite"></div>
        </section>

        <section id="section-join" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-user-plus"></i> زر "انضم إلينا"</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button class="btn btn-outline" data-go="#section-home"><i class="fa-solid fa-arrow-right"></i> رجوع</button>
            </div>
          </div>
          <div class="panel join-panel">
            <div class="join-hero">
              <div class="hero-countdown" id="joinCountdown" aria-live="polite">
                <div class="cd-title"><i class="fa-regular fa-hourglass-half"></i> <span id="joinCountdownLabel">—</span></div>
                <div class="cd-time">
                  <div class="cd-box"><span id="cdDays">00</span><small>يوم</small></div>
                  <div class="cd-sep">:</div>
                  <div class="cd-box"><span id="cdHours">00</span><small>ساعة</small></div>
                  <div class="cd-sep">:</div>
                  <div class="cd-box"><span id="cdMinutes">00</span><small>دقيقة</small></div>
                  <div class="cd-sep">:</div>
                  <div class="cd-box"><span id="cdSeconds">00</span><small>ثانية</small></div>
                </div>
              </div>
            </div>
            <div class="join-content">
              <div class="join-form">
                <form id="joinSettingsForm" class="form-grid">
                  <label class="full-row">
                    طريقة التحكم
                    <div class="segmented">
                      <label style="display:inline-flex;align-items:center;gap:6px;margin-inline-end:8px">
                        <input type="radio" name="joinControlType" id="joinControlTypeManual" value="manual" /> فتح/إغلاق يدوي
                      </label>
                      <label style="display:inline-flex;align-items:center;gap:6px">
                        <input type="radio" name="joinControlType" id="joinControlTypeSchedule" value="schedule" /> الجدولة
                      </label>
                    </div>
                  </label>
                  <div id="joinManualGroup" class="field-group full-row">
                    <div class="field-group__title"><i class="fa-solid fa-toggle-on"></i> التحكم اليدوي</div>
                    <label class="toggle">
                      <input id="joinOpenCheckbox" type="checkbox" />
                      <span class="toggle-track" aria-hidden="true"><span class="toggle-thumb"></span></span>
                      <span class="toggle-label">فتح التسجيل</span>
                    </label>
                  </div>
                  <div id="joinScheduleGroup" class="field-group full-row">
                    <div class="field-group__title"><i class="fa-regular fa-clock"></i> إعداد الجدولة</div>
                    <label class="full-row">
                      نوع الجدولة
                      <div class="segmented">
                        <label style="display:inline-flex;align-items:center;gap:6px;margin-inline-end:8px">
                          <input type="radio" name="joinScheduleMode" id="joinScheduleModeRange" value="range" /> فتح وإغلاق
                        </label>
                        <label style="display:inline-flex;align-items:center;gap:6px;margin-inline-end:8px">
                          <input type="radio" name="joinScheduleMode" id="joinScheduleModeOpenOnly" value="open_only" /> فتح فقط
                        </label>
                        <label style="display:inline-flex;align-items:center;gap:6px">
                          <input type="radio" name="joinScheduleMode" id="joinScheduleModeCloseOnly" value="close_only" /> إغلاق فقط
                        </label>
                      </div>
                      <small class="field-help">اختر نوع الجدولة الأنسب لطبيعة التسجيل في نادي أدِيب</small>
                    </label>
                    <label>
                      تاريخ ووقت الفتح
                      <input id="joinScheduleOpenAt" type="datetime-local" />
                    </label>
                    <label>
                      تاريخ ووقت الإغلاق
                      <input id="joinScheduleCloseAt" type="datetime-local" />
                    </label>
                    <label class="toggle full-row" title="إظهار عداد إغلاق التسجيل في صفحة العضوية">
                      <input id="joinMembershipCountdown" type="checkbox" />
                      <span class="toggle-track" aria-hidden="true"><span class="toggle-thumb"></span></span>
                      <span class="toggle-label">إظهار عداد الإغلاق في صفحة العضوية</span>
                    </label>
                    <div class="full-row muted">المنطقة الزمنية: <span id="joinTimezone"></span></div>
                  </div>
                  <div class="field-group full-row">
                    <div class="field-group__title"><i class="fa-regular fa-message"></i> رسالة الإغلاق</div>
                    <label>
                      عنوان رسالة الإغلاق
                      <input id="joinClosedTitle" type="text" placeholder="مثال: التسجيل مغلق حاليًا" />
                    </label>
                    <label class="full-row">
                      رسالة عند إغلاق التسجيل
                      <textarea id="joinClosedMessage" rows="3" placeholder="اكتب الرسالة التي ستظهر للزوار عند إغلاق التسجيل"></textarea>
                    </label>
                    <label>
                      نص زر التنبيه
                      <input id="joinClosedButtonText" type="text" placeholder="مثال: حسناً" />
                    </label>
                  </div>
                  <div class="full-row">
                    <button type="submit" class="btn btn-primary"><i class="fa-regular fa-floppy-disk"></i> حفظ</button>
                    <button type="button" id="previewClosedMsgBtn" class="btn btn-outline"><i class="fa-regular fa-eye"></i> معاينة الرسالة</button>
                    <span id="joinSettingsMsg" class="muted" style="margin-inline-start:10px"></span>
                  </div>
                </form>
              </div>
              <aside class="settings-summary" aria-live="polite">
                <div class="summary-head"><i class="fa-solid fa-circle-info"></i> ملخص الإعداد</div>
                <div class="summary-row"><span class="label">الحالة الفعلية</span><span id="joinSummaryState" class="status-pill"></span></div>
                <div class="summary-row"><span class="label">طريقة التحكم</span><span id="joinSummaryControl" class="value"></span></div>
                <div class="summary-row"><span class="label">نوع الجدولة</span><span id="joinSummaryMode" class="value"></span></div>
                <div class="summary-row"><span class="label">الأوقات</span><span id="joinSummaryTimes" class="value"></span></div>
                <div class="divider"></div>
                <div class="summary-row"><span class="label">عنوان الرسالة</span><span id="joinSummaryTitle" class="value"></span></div>
                <div class="summary-row"><span class="label">نص الرسالة</span><span id="joinSummaryMessage" class="value"></span></div>
                <div class="summary-row"><span class="label">نص الزر</span><span id="joinSummaryButtonText" class="value"></span></div>
                <div class="summary-row"><span class="label">عداد الإغلاق (العضوية)</span><span id="joinSummaryCountdown" class="value"></span></div>
                <div class="summary-actions">
                  <a class="btn btn-outline" href="../index.html" target="_blank"><i class="fa-solid fa-globe"></i> عرض الصفحة</a>
                </div>
              </aside>
            </div>
          </div>
        </section>

        <section id="section-members" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-users-rectangle"></i> أعضاء النادي</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              
              <button id="addMemberBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة عضو</button>
            </div>
          </div>
          <div id="membersList" class="cards-grid" aria-live="polite"></div>
        </section>

        <section id="section-membership-apps" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-id-badge"></i> طلبات العضوية</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              
              <button id="membershipRefreshBtn" class="btn btn-outline"><i class="fa-solid fa-rotate"></i> تحديث</button>
              <button id="membershipExportBtn" class="btn"><i class="fa-solid fa-file-export"></i> تصدير</button>
            </div>
          </div>
          <div class="cards-grid" id="membershipStatsGrid" aria-live="polite" style="margin-bottom:16px"></div>
          <div id="membershipFilters" class="filters-bar" aria-label="فلاتر طلبات العضوية" style="margin-bottom:12px">
            <div class="filter-field">
              <i class="icon fa-solid fa-magnifying-glass" aria-hidden="true"></i>
              <input id="membershipFilterName" class="filter-input with-icon" type="text" placeholder="بحث بالاسم" />
            </div>
            <div class="filter-field">
              <i class="icon fa-solid fa-layer-group" aria-hidden="true"></i>
              <select id="membershipFilterStatus" class="filter-select with-icon" title="تصفية حسب الحالة">
                <option value="all">كل الحالات</option>
                <option value="pending">قيد الانتظار</option>
                <option value="review">مراجعة</option>
                <option value="interview">مُقابلة</option>
                <option value="accepted">مقبول</option>
                <option value="rejected">مرفوض</option>
              </select>
            </div>
            <div class="filter-field">
              <i class="icon fa-solid fa-percent" aria-hidden="true"></i>
              <select id="membershipFilterPctBand" class="filter-select with-icon" title="تصفية حسب نسبة الإكمال">
                <option value="all">كل النسب</option>
                <option value="50">50% - 59%</option>
                <option value="60">60% - 69%</option>
                <option value="70">70% - 79%</option>
                <option value="80">80% - 89%</option>
                <option value="90">90% - 99%</option>
                <option value="100">100%</option>
              </select>
            </div>
            <div class="filter-field">
              <i class="icon fa-solid fa-users" aria-hidden="true"></i>
              <select id="membershipFilterCommittee" class="filter-select with-icon" title="تصفية حسب اللجنة">
                <option value="all">كل اللجان</option>
              </select>
            </div>
            <div style="flex:1 0 100%; grid-column: 1 / -1;">
              <button id="membershipFiltersClear" class="btn btn-outline btn-xs" type="button" title="مسح الفلاتر" style="width:100%"><i class="fa-solid fa-eraser"></i> أسمح كل الفلاتر</button>
            </div>
          </div>
          <div id="membershipAppsGroups" class="groups-grid"></div>
          <div id="membershipAppsEmpty" class="empty-state muted" style="display:none">لا توجد طلبات بعد</div>
          <dialog id="membershipAppDetailsDialog" class="admin-dialog">
            <form method="dialog" class="dialog-form" id="membershipAppDetailsForm">
              <div class="dialog-header">
                <h3 class="dialog-title">تفاصيل طلب العضوية</h3>
                <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
              </div>
              <div class="dialog-body">
                <div class="membership-details">
                  <div class="details-row cols-1">
                    <label class="detail">الأسم الثلاثي<div id="membershipAppDetailsName" class="muted"></div></label>
                  </div>
                  <div class="details-row cols-2">
                    <label class="detail">الجوال<div id="membershipAppDetailsPhone" class="muted"></div></label>
                    <label class="detail">البريد الإلكتروني<div id="membershipAppDetailsEmail" class="muted"></div></label>
                  </div>
                  <div class="details-row cols-3">
                    <label class="detail">الدرجة العلمية<div id="membershipAppDetailsDegree" class="muted"></div></label>
                    <label class="detail">الكلية<div id="membershipAppDetailsCollege" class="muted"></div></label>
                    <label class="detail">التخصص<div id="membershipAppDetailsMajor" class="muted"></div></label>
                  </div>
                  <div class="details-row cols-1">
                    <label class="detail">اللجنة<div id="membershipAppDetailsCommittee" class="muted"></div></label>
                  </div>
                  <div class="details-row cols-1">
                    <label class="detail">المهارات<div id="membershipAppDetailsSkills" class="muted" style="white-space:pre-wrap"></div></label>
                  </div>
                  <div class="details-row cols-1">
                    <label class="detail">أعمال سابقة<div id="membershipAppDetailsPortfolio" class="muted"></div></label>
                  </div>
                  <div class="details-row cols-3">
                    <label class="detail">تويتر<div id="membershipAppDetailsTwitter" class="muted"></div></label>
                    <label class="detail">إنستقرام<div id="membershipAppDetailsInstagram" class="muted"></div></label>
                    <label class="detail">تيك توك<div id="membershipAppDetailsLinkedin" class="muted"></div></label>
                  </div>
                  <div class="details-row cols-1">
                    <label class="detail">النبذة<div id="membershipAppDetailsAbout" class="muted" style="white-space:pre-wrap"></div></label>
                  </div>
                  <div class="details-row cols-1">
                    <label class="detail">التاريخ<div id="membershipAppDetailsDate" class="muted"></div></label>
                  </div>
                  <div class="details-row cols-1">
                    <label class="detail">الحالة<select id="membershipAppStatusSelect">
                      <option value="pending">قيد الانتظار</option>
                      <option value="review">مراجعة</option>
                      <option value="interview">مُقابلة</option>
                      <option value="accepted">مقبول</option>
                      <option value="rejected">مرفوض</option>
                    </select></label>
                  </div>
                  <div class="details-row cols-1">
                    <div class="notes-card" id="membershipAppNotesCard">
                      <div class="notes-card__head">
                        <i class="fa-solid fa-comments" aria-hidden="true"></i>
                        <span class="notes-card__title">ملاحظات الإداريين</span>
                        <span class="notes-card__count" id="membershipAppNotesCount">0</span>
                      </div>
                      <div class="notes-card__composer">
                        <textarea id="membershipAppNoteInput" rows="2" placeholder="أضف ملاحظة تظهر لجميع الإداريين"></textarea>
                        <button type="button" class="btn btn-primary" id="membershipAppNoteAdd"><i class="fa-solid fa-paper-plane"></i> إضافة</button>
                      </div>
                      <div class="notes-card__list" id="membershipAppNotesList" aria-live="polite"></div>
                      <small id="membershipAppNotesStatus" class="field-help" style="display:none"></small>
                    </div>
                  </div>
                </div>
              </div>
              <menu class="dialog-actions">
                <button type="button" class="btn" onclick="this.closest('dialog').close()">إغلاق</button>
              </menu>
            </form>
          </dialog>
          <dialog id="membershipExportDialog" class="admin-dialog">
            <form method="dialog" class="dialog-form" id="membershipExportForm">
              <div class="dialog-header">
                <h3 class="dialog-title"><i class="fa-solid fa-file-export"></i> تصدير طلبات العضوية</h3>
                <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
              </div>
              <div class="dialog-body">
                <div class="details-row cols-1">
                  <label class="detail">اللجنة
                    <select id="membershipExportCommittee">
                      <option value="all">كل اللجان</option>
                    </select>
                  </label>
                </div>
                <div class="details-row cols-1">
                  <label class="detail">الحقول المراد تصديرها</label>
                  <div id="membershipExportFields" class="checkbox-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:8px;margin-top:8px"></div>
                </div>
                <div class="muted" id="membershipExportHint" style="margin-top:8px">سيتم تنزيل ملف CSV يمكن فتحه مباشرةً في Google Sheets.</div>
              </div>
              <menu class="dialog-actions">
                <button type="submit" class="btn btn-primary" id="membershipExportSubmit"><i class="fa-solid fa-download"></i> تنزيل CSV</button>
                <button type="button" class="btn btn-outline" onclick="this.closest('dialog').close()">إلغاء</button>
              </menu>
            </form>
          </dialog>
        </section>

        <section id="section-faq" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-question-circle"></i> إدارة الأسئلة الشائعة</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button class="btn btn-outline" data-go="#section-home"><i class="fa-solid fa-arrow-right"></i> رجوع</button>
              <button id="addFaqBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة سؤال</button>
            </div>
          </div>
          <div id="faqList" class="cards-grid" aria-live="polite"></div>
        </section>

        <section id="section-testimonials" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-star"></i> إدارة آراء الأعضاء</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button class="btn btn-outline" data-go="#section-home"><i class="fa-solid fa-arrow-right"></i> رجوع</button>
              <button id="addTestimonialBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة رأي</button>
            </div>
          </div>
          <div id="testimonialsList" class="cards-grid" aria-live="polite"></div>
        </section>

        <section id="section-blog" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-anchor"></i> إدارة مرافئ</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button class="btn btn-outline" data-go="#section-home"><i class="fa-solid fa-arrow-right"></i> رجوع</button>
              <button id="addPostBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة تدوينة</button>
            </div>
          </div>
          <div id="blogList" class="cards-grid" aria-live="polite"></div>
        </section>
        <section id="section-schedule" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-calendar-days"></i> جدول أدِيب</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              
            </div>
          </div>
          <div id="schedulePanel" class="panel" style="padding:16px">
            <div class="calendar-toolbar">
              <button id="calPrevBtn" class="btn btn-outline" title="الشهر السابق"><i class="fa-solid fa-chevron-right"></i></button>
              <div id="calMonthLabel" class="calendar-month"></div>
              <button id="calNextBtn" class="btn btn-outline" title="الشهر التالي"><i class="fa-solid fa-chevron-left"></i></button>
              <div style="flex:1"></div>
              <button id="calTodayBtn" class="btn"><i class="fa-solid fa-location-crosshairs"></i> عرض اليوم </button>
              <button id="calIntlBtn" class="btn btn-outline" title="إضافة الأيام العالمية لهذا الشهر"><i class="fa-solid fa-earth-asia"></i> عرض الأيام العالمية </button>
            </div>
            <div class="calendar-days-head" id="calendarDaysHead"></div>
            <div id="calendarGrid" class="calendar-grid" aria-live="polite"></div>
          </div>
          <!-- International Days: separate panel -->
          <div id="intlDaysPanel" class="panel" style="padding:16px; margin-top:16px">
            <div id="intlDaysSection">
              <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;margin:0 0 12px">
                <h3 style="margin:0;font-size:1rem;color:var(--main-blue)"><i class="fa-solid fa-earth-asia"></i> الأيام العالمية لهذا الشهر</h3>
                <div style="display:flex;gap:8px;align-items:center">
                  <button id="intlAddCustomBtn" class="btn btn-outline"><i class="fa-solid fa-plus"></i> إضافة يوم عالمي</button>
                </div>
              </div>
              <div id="intlDaysTableWrap" style="overflow:auto">
                <table class="table" style="width:100%; border-collapse:collapse">
                  <thead>
                    <tr>
                      <th style="text-align:right; padding:12px">التاريخ</th>
                      <th style="text-align:right; padding:12px">العنوان</th>
                      <th style="text-align:right; padding:12px">إجراء</th>
                    </tr>
                  </thead>
                  <tbody id="intlDaysTableBody"></tbody>
                </table>
                <div class="muted" id="intlDaysFootnote" style="margin-top:8px">القائمة ثابتة؛ وقد لا تشمل جميع الأيام العالمية</div>
              </div>
            </div>
          </div>
        </section>
        <section id="section-idea-board" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-lightbulb"></i> سبورة أدِيب (إدارة)</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              
              <a id="openIdeaBoardBtn" class="btn" href="../board/board.html" target="_blank"><i class="fa-solid fa-globe"></i> فتح الصفحة العامة</a>
              <button id="ideaBoardRefreshBtn" class="btn"><i class="fa-solid fa-rotate"></i> تحديث</button>
            </div>
          </div>
          <!-- Topics manager -->
          <div class="panel" style="padding:16px; margin-bottom:16px">
            <div style="display:flex;align-items:center;gap:8px; margin-bottom:10px">
              <h3 style="margin:0;font-size:1rem;color:var(--main-blue)"><i class="fa-solid fa-book-open"></i> المواضيع</h3>
              <div style="flex:1"></div>
              <button id="addTopicBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة موضوع</button>
              <button id="ideaTopicsRefreshBtn" class="btn btn-outline"><i class="fa-solid fa-rotate"></i> تحديث</button>
            </div>
            <div id="ideaTopicsList" class="cards-grid" aria-live="polite"></div>
            <div id="ideaTopicsEmpty" class="empty-state muted" style="display:none">لا توجد مواضيع بعد</div>
          </div>
          <div class="panel" style="padding:16px">
            <div id="ideaBoardList" class="simple-list" aria-live="polite"></div>
            <div id="ideaBoardEmpty" class="empty-state muted" style="display:none">لا توجد أفكار بعد</div>
          </div>
          <!-- Idea Details Dialog -->
          <dialog id="ideaDetailsDialog" class="admin-dialog">
            <form method="dialog" class="dialog-form" id="ideaDetailsForm">
              <div class="dialog-header">
                <h3 class="dialog-title">تفاصيل الفكرة</h3>
                <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
              </div>
              <div class="dialog-body">
                <div class="form-grid" style="grid-template-columns: 1fr 1fr">
                  <label>العنوان<div id="ideaDetailsTitle" class="muted"></div></label>
                  <label>الاسم<div id="ideaDetailsAuthor" class="muted"></div></label>
                  <label>التاريخ<div id="ideaDetailsDate" class="muted"></div></label>
                  <label>الموضوع<div id="ideaDetailsTopic" class="muted"></div></label>
                  <label style="grid-column: 1 / -1">المحتوى<div id="ideaDetailsContent" class="muted" style="white-space:pre-wrap"></div></label>
                </div>
              </div>
              <menu class="dialog-actions">
                <button type="button" class="btn btn-outline" id="ideaPinToggleBtn"><i class="fa-solid fa-thumbtack"></i> تبديل التثبيت</button>
                <button type="button" class="btn btn-outline" id="ideaVisToggleBtn"><i class="fa-solid fa-eye"></i> إظهار/إخفاء</button>
                <button type="button" class="btn btn-outline" id="ideaDeleteBtn"><i class="fa-regular fa-trash-can"></i> حذف</button>
              </menu>
            </form>
          </dialog>
          <!-- Topic Dialog -->
          <dialog id="topicDialog" class="admin-dialog">
            <form method="dialog" class="dialog-form" id="topicForm">
              <div class="dialog-header">
                <h3 class="dialog-title">إضافة/تعديل موضوع</h3>
                <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
              </div>
              <div class="dialog-body">
                <div class="form-grid">
                  <label>
                    العنوان
                    <input id="topicTitle" type="text" placeholder="عنوان الموضوع" required />
                  </label>
                  <label>
                    الوصف (اختياري)
                    <textarea id="topicDesc" rows="3" placeholder="نبذة مختصرة"></textarea>
                  </label>
                  <label>
                    صورة (اختياري)
                    <input id="topicImageFile" type="file" accept="image/*" />
                    <small class="field-help">PNG/JPG/WebP حتى 5MB</small>
                  </label>
                  <div id="topicImagePreviewWrap" class="img-preview" style="display:none">
                    <img id="topicImagePreview" alt="معاينة" />
                    <button type="button" class="btn btn-outline btn-xs" id="topicClearImageBtn"><i class="fa-solid fa-xmark"></i> إزالة</button>
                  </div>
                  <label style="display:flex;align-items:center;gap:8px">
                    <input id="topicVisible" type="checkbox" checked />
                    ظاهر للجميع
                  </label>
                </div>
              </div>
              <menu class="dialog-actions">
                <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
                <button value="submit" class="btn btn-primary"><i class="fa-regular fa-floppy-disk"></i> حفظ</button>
              </menu>
            </form>
          </dialog>
        </section>
        <!-- المحادثات بين الإداريين -->
        <section id="section-chat" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-comments"></i> المحادثات</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              
            </div>
          </div>
          <div class="panel" style="padding:0">
            <div class="chat-layout">
              <!-- جهات الاتصال -->
              <aside class="chat-contacts-pane">
                <div class="chat-search">
                  <input id="chatSearch" type="text" placeholder="ابحث عن إداري بالاسم" />
                </div>
                <div id="chatFilters" class="chat-filters" aria-label="مرشحات">
                  <button type="button" class="chip active" data-filter="all">الكل</button>
                  <button type="button" class="chip" data-filter="high">المجلس الأعلى</button>
                  <button type="button" class="chip" data-filter="admins">الإداريون</button>
                </div>
                <div id="chatNoContacts" class="empty-state muted" style="display:none">لا يوجد إداريون متاحون.</div>
                <div id="chatContacts" class="chat-contacts" aria-live="polite"></div>
              </aside>
              <!-- نافذة الرسائل -->
              <section class="chat-main-pane">
                <div class="chat-header">
                  <div class="chat-peer">
                    <div id="chatPeerAvatar" class="avatar"></div>
                    <div>
                      <div id="chatPartnerName" class="chat-peer__name">—</div>
                      <div id="chatPeerMeta" class="chat-peer__meta muted"></div>
                    </div>
                    <div style="flex:1"></div>
                  </div>
                </div>
                <div class="chat-history-tools">
                  <button id="chatLoadMore" class="btn btn-outline small" style="display:none"><i class="fa-solid fa-clock-rotate-left"></i> عرض أقدم</button>
                </div>
                <div id="chatMessages" class="chat-messages" aria-live="polite"></div>
                <div id="chatEmpty" class="empty-state muted" style="display:none; padding:8px 12px">اختر جهة اتصال لبدء المحادثة</div>
                <button id="chatScrollBottom" class="chat-scroll-bottom btn btn-outline" style="display:none" title="الانتقال لآخر الرسائل"><i class="fa-solid fa-arrow-down"></i></button>
                <div id="chatTyping" class="chat-typing muted" style="display:none">يكتب الآن…</div>
                <form id="chatComposer" class="chat-composer">
                  <input id="chatInput" type="text" placeholder="اكتب رسالة..." autocomplete="off" />
                  <button id="chatSendBtn" class="btn btn-primary" type="submit"><i class="fa-solid fa-paper-plane"></i> إرسال</button>
                </form>
              </section>
            </div>
          </div>
        </section>
        <section id="section-todos" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-list-check"></i> المهام</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              
              <button id="addTodoBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة مهمة</button>
            </div>
          </div>
          <div id="todosList" class="cards-grid" aria-live="polite"></div>
        </section>
        
        <section id="section-appointments" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-calendar-check"></i> حجز المواعيد</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button id="addAppointmentBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إضافة موعد</button>
            </div>
          </div>
          <div id="appointmentsList" class="cards-grid" aria-live="polite"></div>
          <div class="panel" style="padding:16px; margin-top:16px" id="bookingsPanel">
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:8px">
              <h3 style="margin:0;font-size:1rem;color:var(--main-blue)"><i class="fa-solid fa-calendar-check"></i> حجوزات المواعيد</h3>
              <div style="flex:1"></div>
              <select id="bookingAppointmentSelect">
                <option value="all">جميع المواعيد</option>
              </select>
              <button id="bookingsRefreshBtn" class="btn btn-outline"><i class="fa-solid fa-rotate"></i> تحديث</button>
              <button id="bookingsExportBtn" class="btn"><i class="fa-solid fa-file-export"></i> تصدير</button>
            </div>
            <div style="overflow:auto">
              <div id="bookingsCards" class="cards-grid" aria-live="polite"></div>
              <div id="bookingsEmpty" class="empty-state muted" style="display:none">لا توجد حجوزات</div>
            </div>
          </div>
        </section>
        
        <!-- إرسال الإشعارات -->
        <section id="section-push" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-bell"></i> إرسال الإشعارات</h2>
            <button id="testPushBtn" class="btn btn-outline"><i class="fa-solid fa-vial"></i> إرسال إشعار تجريبي لنفسي</button>
          </div>
          <div class="panel" style="padding:24px">
            <form id="pushNotificationForm" class="form-grid" style="gap:16px">
              <label style="grid-column:1/-1">
                عنوان الإشعار
                <input type="text" id="pushTitle" placeholder="مثال: إعلان مهم" required />
              </label>
              <label style="grid-column:1/-1">
                نص الإشعار
                <textarea id="pushBody" placeholder="اكتب محتوى الإشعار هنا..." rows="3" required></textarea>
              </label>
              <label style="grid-column:1/-1">
                الرابط عند النقر (اختياري)
                <input type="url" id="pushUrl" placeholder="https://www.adeeb.club/" />
              </label>
              <label style="grid-column:1/-1">
                <input type="checkbox" id="pushToAll" checked /> إرسال لجميع المستخدمين المشتركين
              </label>
              <div style="grid-column:1/-1;display:none" id="pushUserSelect">
                <label>
                  اختر مستخدمين محددين
                  <select id="pushUserIds" multiple style="min-height:120px">
                    <option value="">جاري التحميل...</option>
                  </select>
                  <small class="field-help">اضغط Ctrl للاختيار المتعدد</small>
                </label>
              </div>
              <div style="grid-column:1/-1;display:flex;gap:8px">
                <button type="submit" class="btn btn-primary"><i class="fa-solid fa-paper-plane"></i> إرسال الإشعار</button>
                <button type="button" id="pushPreviewBtn" class="btn btn-outline"><i class="fa-solid fa-eye"></i> معاينة</button>
              </div>
            </form>
            <div id="pushStats" style="margin-top:24px;padding:16px;background:#f8fafc;border-radius:8px;display:none">
              <h4 style="margin:0 0 8px">إحصائيات الإرسال</h4>
              <div id="pushStatsContent"></div>
            </div>
          </div>
        </section>
        
        <!-- ملفي -->
        <section id="section-profile" class="admin-section">
          <div class="section-head">
            <h2><i class="fa-solid fa-id-card"></i> ملفي</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button id="installAppBtn" class="btn btn-primary" style="display:none"><i class="fa-solid fa-download"></i> تثبيت التطبيق</button>
              <button id="enablePushBtn" class="btn btn-outline" style="display:none"><i class="fa-solid fa-bell"></i> تفعيل الإشعارات</button>
              <span id="installAppHint" class="muted" style="font-size:12px; margin-inline-start:8px; display:none"></span>
              <span id="pushStatus" class="muted" style="font-size:12px; margin-inline-start:8px; display:none"></span>
            </div>
          </div>
          <div class="panel" style="padding:16px">
            <div style="display:flex; gap:16px; align-items:center; flex-wrap:wrap">
              <div id="adminAvatarPreview" class="avatar" style="width:64px; height:64px; border-radius:50%; overflow:hidden; display:flex; align-items:center; justify-content:center; background:#f1f5f9"></div>
              <div>
                <div id="adminProfileUserName" style="font-weight:700; font-size:18px"></div>
                <div id="adminProfileEmail" class="muted" style="font-size:13px"></div>
              </div>
            </div>
          </div>
          <div class="panel" style="padding:16px; margin-top:16px">
            <form id="adminProfileForm" class="form-grid">
              <label>
                الاسم المعروض
                <input id="admin_display_name" type="text" placeholder="اسمك" />
              </label>
              <label>
                المسمى الوظيفي / المنصب
                <input id="admin_position" type="text" placeholder="مثال: مشرف عام" readonly />
                <small class="field-help">يتم تحديد المنصب عند إضافة الإداري ولا يمكن تغييره من قبل الإداري.</small>
              </label>
              <label>
                رقم الجوال
                <input id="admin_phone" type="tel" inputmode="tel" placeholder="05xxxxxxxx" />
              </label>
              <label>
                صورة الحساب
                <input id="admin_avatar_file" type="file" accept="image/*" />
                <small class="field-help">اختر صورة جديدة لتحديث الصورة الرمزية.</small>
              </label>
              <div>
                <button type="submit" class="btn btn-primary"><i class="fa-regular fa-floppy-disk"></i> حفظ الملف</button>
                <span id="adminProfileMsg" class="muted" style="margin-inline-start:10px"></span>
              </div>
            </form>
          </div>

          <!-- تغيير كلمة المرور -->
          <div class="panel" style="padding:16px; margin-top:16px">
            <h3 style="margin-top:0"><i class="fa-solid fa-key"></i> تغيير كلمة المرور</h3>
            <form id="adminChangePasswordForm" class="form-grid">
              <label>
                الكلمة الحالية
                <input id="admin_current_password" type="password" autocomplete="current-password" />
              </label>
              <label>
                الكلمة الجديدة
                <input id="admin_new_password" type="password" autocomplete="new-password" />
              </label>
              <label>
                تأكيد الكلمة الجديدة
                <input id="admin_confirm_password" type="password" autocomplete="new-password" />
              </label>
              <div style="display:flex;align-items:end;gap:8px">
                <button type="submit" class="btn btn-primary"><i class="fa-regular fa-floppy-disk"></i> حفظ</button>
                <span id="adminPasswordMsg" class="muted"></span>
              </div>
            </form>
          </div>

          <!-- تغيير البريد الإلكتروني -->
          <div class="panel" style="padding:16px; margin-top:16px">
            <h3 style="margin-top:0"><i class="fa-solid fa-at"></i> تغيير البريد الإلكتروني</h3>
            <form id="adminChangeEmailForm" class="form-grid">
              <label>
                بريدك الحالي
                <input id="admin_current_email_display" type="email" readonly />
              </label>
              <label>
                البريد الجديد
                <input id="admin_new_email" type="email" placeholder="name@example.com" />
              </label>
              <label>
                كلمة المرور الحالية للتحقق
                <input id="admin_current_password_email" type="password" autocomplete="current-password" />
              </label>
              <div style="display:flex;align-items:end;gap:8px">
                <button type="submit" class="btn btn-primary"><i class="fa-regular fa-paper-plane"></i> إرسال تأكيد</button>
                <span id="adminEmailMsg" class="muted"></span>
              </div>
            </form>
          </div>
        </section>

        <!-- إدارة الأعضاء الإداريين -->
        <section id="section-admins" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-user-shield"></i> إدارة الأعضاء الإداريين</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              
            </div>
          </div>

          <div class="panel" style="padding:16px">
            <form id="addAdminForm" class="form-grid">
              <label>
                البريد الإلكتروني
                <input id="newAdminEmail" type="email" placeholder="name@example.com" required />
              </label>
              <!-- removed full name input -->
              <label>
                المنصب
                <select id="newAdminPosition">
                  <option value="">اختر المنصب</option>
                  <option>رئيس أدِيب</option>
                  <option>نائب الرئيس - شطر الطالبات</option>
                  <option>نائب الرئيس - شطر الطلاب</option>
                  <option>قائد الرواة</option>
                  <option>قائد التأليف</option>
                  <option>قائد السفراء</option>
                  <option>قائد الفعاليات</option>
                  <option>قائد الإنتاج</option>
                  <option>قائد التصميم</option>
                  <option>مُشرف التحرير</option>
                  <option>مُشرف التسويق</option>
                  <option>مُشرف الأرشيف</option>
                  <option>عضو إداري</option>
                </select>
              </label>
              <div class="field-group" style="grid-column:1/-1">
                <details id="invitePermsWrap">
                  <summary class="field-group__title"><i class="fa-solid fa-lock"></i> الصلاحيات عند الدعوة (اختياري)</summary>
                  <div id="invitePermsGrid" class="perm-grid">
                  <label class="perm"><input type="checkbox" id="inv-perm-works" /><span class="name">إدارة الأعمال</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-sponsors" /><span class="name">إدارة الرعاة</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-achievements" /><span class="name">إدارة الإنجازات</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-board" /><span class="name">المجلس الإداري</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-members" /><span class="name">أعضاء النادي</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-membership_apps" /><span class="name">طلبات العضوية</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-faq" /><span class="name">الأسئلة الشائعة</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-blog" /><span class="name">مرافئ (المدونة)</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-idea_board" /><span class="name">سبورة أدِيب</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-chat" /><span class="name">المحادثات</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-schedule" /><span class="name">جدول أدِيب</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-appointments" /><span class="name">حجز المواعيد</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-todos" /><span class="name">المهام</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-admins" /><span class="name">إدارة الأعضاء الإداريين</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-testimonials" /><span class="name">آراء الأعضاء</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-join" /><span class="name">زر "انضم إلينا"</span><span class="switch" aria-hidden="true"></span></label>
                  <label class="perm"><input type="checkbox" id="inv-perm-push" /><span class="name">إرسال الإشعارات</span><span class="switch" aria-hidden="true"></span></label>
                  </div>
                  <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
                    <button type="button" class="btn" id="invPermsSelectAll">تحديد الكل</button>
                    <button type="button" class="btn" id="invPermsClearAll">مسح الكل</button>
                  </div>
                </details>
              </div>
              <button class="btn btn-primary" type="submit"><i class="fa-solid fa-paper-plane"></i> إرسال دعوة كإداري</button>
            </form>
            <div id="adminsStatus" class="muted" style="margin-top:10px"></div>
          </div>

          <!-- High Council Table -->
          <div class="panel" style="padding:16px; margin-top:16px">
            <h3 style="margin:0 0 12px; font-family: fb; color: var(--main-blue); display:flex; align-items:center; gap:8px">
              <i class="fa-solid fa-crown" aria-hidden="true"></i> المجلس الأعلى
            </h3>
            <div style="overflow:auto">
              <table class="table" style="width:100%; border-collapse:collapse">
                <thead>
                  <tr>
                    <th style="text-align:right; padding:12px">العضو</th>
                    <th style="text-align:right; padding:12px">إجراءات</th>
                  </tr>
                </thead>
                <tbody id="adminsHighCouncilTable"></tbody>
              </table>
            </div>
          </div>

          <!-- Administrative Council Table -->
          <div class="panel" style="padding:16px; margin-top:16px">
            <h3 style="margin:0 0 12px; font-family: fb; color: var(--main-blue); display:flex; align-items:center; gap:8px">
              <i class="fa-solid fa-users-gear" aria-hidden="true"></i> المجلس الإداري
            </h3>
            <div style="overflow:auto">
              <table class="table" style="width:100%; border-collapse:collapse">
                <thead>
                  <tr>
                    <th style="text-align:right; padding:12px">العضو</th>
                    <th style="text-align:right; padding:12px">إجراءات</th>
                  </tr>
                </thead>
                <tbody id="adminsAdminCouncilTable"></tbody>
              </table>
            </div>
          </div>
        </section>

          <section id="section-forms" class="admin-section" hidden>
          <div class="section-head">
            <h2><i class="fa-solid fa-list-check"></i> إدارة الاستبيانات</h2>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <button class="btn btn-outline" data-go="#section-home"><i class="fa-solid fa-arrow-right"></i> رجوع</button>
              <button id="addFormBtn" class="btn btn-primary"><i class="fa-solid fa-plus"></i> إنشاء استبيان</button>
            </div>
          </div>
          <div id="formsList" class="cards-grid forms-grid" aria-live="polite"></div>
          
          <style>
            .forms-grid .card {
              min-width: 350px;
              max-width: 500px;
            }
            
            .status-pill {
              display: inline-flex;
              align-items: center;
              padding: 4px 8px;
              border-radius: 12px;
              font-size: 0.75rem;
              font-weight: 500;
              background: #f1f5f9;
              color: #64748b;
              border: 1px solid #e2e8f0;
            }
            
            .status-pill.status-ok {
              background: #dcfce7;
              color: #166534;
              border-color: #bbf7d0;
            }
            
            .forms-grid .btn {
              font-size: 0.875rem;
              padding: 8px 12px;
              white-space: nowrap;
              text-overflow: ellipsis;
              overflow: hidden;
            }
            
            .forms-grid .btn i {
              margin-left: 6px;
              flex-shrink: 0;
            }
            
            @media (max-width: 768px) {
              .forms-grid .card {
                min-width: 100%;
              }
              
              .forms-grid .btn {
                min-width: 100% !important;
                flex: none !important;
              }
            }
          </style>
        </section>

      </main>
    </div>

    <!-- Dialogs -->
    <!-- Image Cropper Dialog -->
    <dialog id="imageCropDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="imageCropForm">
        <div class="dialog-header">
          <h3 class="dialog-title">قص الصورة</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div id="cropToolbar" style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:10px">
            <label style="display:flex;align-items:center;gap:6px">
              نسبة القص
              <select id="cropAspectSelect">
                <option value="auto">تلقائي</option>
                <option value="1">1:1</option>
                <option value="4/3">4:3</option>
                <option value="16/9">16:9</option>
              </select>
            </label>
            <div style="flex:1"></div>
            <button type="button" class="btn btn-outline" id="cropZoomIn" title="تكبير"><i class="fa-solid fa-magnifying-glass-plus"></i></button>
            <button type="button" class="btn btn-outline" id="cropZoomOut" title="تصغير"><i class="fa-solid fa-magnifying-glass-minus"></i></button>
            <button type="button" class="btn btn-outline" id="cropRotateL" title="تدوير يسار"><i class="fa-solid fa-rotate-left"></i></button>
            <button type="button" class="btn btn-outline" id="cropRotateR" title="تدوير يمين"><i class="fa-solid fa-rotate-right"></i></button>
            <button type="button" class="btn btn-outline" id="cropFlipH" title="عكس أفقي"><i class="fa-solid fa-arrows-left-right"></i></button>
            <button type="button" class="btn btn-outline" id="cropFlipV" title="عكس عمودي"><i class="fa-solid fa-arrows-up-down"></i></button>
            <button type="button" class="btn" id="cropReset" title="إعادة الضبط"><i class="fa-solid fa-undo"></i> إعادة</button>
          </div>
          <div id="cropperArea">
            <img id="cropperImage" alt="معاينة القص" />
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
            <small class="field-help">اسحب وحدد الإطار ثم اضغط تأكيد للحفظ.</small>
            <small id="cropBusy" class="field-help" style="display:none;color:#0ea5e9">جارٍ المعالجة...</small>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" id="cropCancelBtn">إلغاء</button>
          <button value="submit" class="btn btn-primary" id="cropConfirmBtn">تأكيد</button>
        </menu>
      </form>
    </dialog>

    <dialog id="memberDetailsDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form">
        <div class="dialog-header">
          <h3 class="dialog-title"><i class="fa-regular fa-eye"></i> تفاصيل العضو</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div id="memberDetailsContent"></div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إغلاق</button>
        </menu>
      </form>
    </dialog>

    <dialog id="memberDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="memberForm">
        <div class="dialog-header">
          <h3 class="dialog-title">إضافة/تعديل عضو</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid">
            <label>الاسم الكامل<input name="full_name" required placeholder="اسم العضو" /></label>
            <label>البريد الإلكتروني<input name="email" type="email" placeholder="name@example.com" /></label>
            <label>رقم الجوال<input name="phone" type="tel" inputmode="tel" placeholder="05xxxxxxxx" /></label>
            <label>الكلية<input name="college" placeholder="مثال: كلية الآداب" /></label>
            <label>التخصص<input name="major" placeholder="مثال: اللغة العربية" /></label>
            <label>الرقم الأكاديمي<input name="academic_number" placeholder="مثال: 441234567" /></label>
            <label>رقم الهوية الوطنية<input name="national_id" placeholder="مثال: 10xxxxxxxxx" /></label>
            <label>الدرجة العلمية
              <select name="degree">
                <option value="">اختر الدرجة</option>
                <option>المرحلة الثانوية</option>
                <option>دبلوم</option>
                <option>بكالوريوس</option>
                <option>ماجستير</option>
                <option>دكتوراه</option>
                <option>موظف</option>
              </select>
            </label>
            <label>تاريخ الميلاد<input name="birth_date" type="date" /></label>
            <label>اللجنة
              <select name="committee">
                <option value="">اختر اللجنة</option>
                <option value="">بدون لجنة</option>
                <option>المَجلِس الإداريِّ</option>
                <option>لجنَة الإِنتَاج</option>
                <option>لجنَة التَّألِيف</option>
                <option>لجنَة التَّسوِيق</option>
                <option>لجنَة التَّصمِيم</option>
                <option>لجنَة الرُّوَاة</option>
                <option>لجنَة السُّفرَاء</option>
                <option>لجنَة الفَعالِيَّات</option>
              </select>
            </label>
            <label>حساب منصة أكس (X)<input name="x_handle" placeholder="مثال: @username أو username" /></label>
            <label>حساب الانستقرام<input name="instagram_handle" placeholder="مثال: username" /></label>
            <label>حساب تيك توك<input name="tiktok_handle" placeholder="مثال: @username أو username" /></label>
            <label>اللون الأساسي<input name="primary_color" type="color" value="#3D8FD6" /></label>
            <label>اللون الثانوي<input name="secondary_color" type="color" value="#274060" /></label>

            <label>صورة العضو
              <div id="memberDropzone" class="upload-dropzone" tabindex="0" role="button" aria-label="رفع صورة بالضغط أو السحب والإفلات">
                <i class="fa-regular fa-image" aria-hidden="true"></i>
                <div class="dz-text">
                  <strong>اسحب وأفلت الصورة هنا</strong>
                  <span id="memberBrowseBtn">أو اضغط لاختيار الصورة من جهازك</span>
                </div>
              </div>
              <input id="member_image_file" type="file" accept="image/*" style="display:none" />
              <input id="member_image_url" name="avatar_url" type="hidden" />
              <div style="display:flex;justify-content:center;">
                <img id="member_image_preview" alt="معاينة الصورة" class="image-preview" />
              </div>
              <div id="memberImageActions" class="image-actions" style="display:none">
                <button type="button" class="btn btn-outline" id="member_edit_image_btn"><i class="fa-regular fa-pen-to-square"></i> تعديل الصورة</button>
                <button type="button" class="btn btn-outline" id="member_change_image_btn"><i class="fa-regular fa-image"></i> تغيير الصورة</button>
              </div>
            </label>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary">حفظ</button>
        </menu>
      </form>
    </dialog>

    <!-- International Day: Add Custom Dialog -->
    <dialog id="intlCustomDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="intlCustomForm">
        <div class="dialog-header">
          <h3 class="dialog-title"><i class="fa-solid fa-earth-asia"></i> إضافة يوم عالمي</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid">
            <label>التاريخ
              <input id="intlCustomDate" type="date" required />
            </label>
            <label>العنوان
              <input id="intlCustomTitle" type="text" required placeholder="اسم اليوم العالمي" />
            </label>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary"><i class="fa-regular fa-floppy-disk"></i> حفظ</button>
        </menu>
      </form>
    </dialog>
    <dialog id="workDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="workForm">
        <div class="dialog-header">
          <h3 class="dialog-title">إضافة/تعديل عمل</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid">
            <label>العنوان<input name="title" required /></label>
            <label>الفئة<input name="category" placeholder="فلم قصير، مبادرة.." /></label>
            <label>صورة العمل
              <div id="workDropzone" class="upload-dropzone" tabindex="0" role="button" aria-label="رفع صورة بالضغط أو السحب والإفلات">
                <i class="fa-regular fa-image" aria-hidden="true"></i>
                <div class="dz-text">
                  <strong>اسحب وأفلت الصورة هنا</strong>
                  <span id="workBrowseBtn">أو اضغط لأختيار الصورة من جهازك</span>
                </div>
                <!-- <span class="dz-hint">الامتدادات المدعومة: JPG, PNG, WEBP • حتى 5MB</span> -->
              </div>
              <input id="work_image_file" type="file" accept="image/*" style="display:none" />
              <input id="work_image_url" name="image_url" type="hidden" />
              <small id="work_image_help" class="field-help">يمكنك السحب والإفلات أو الضغط للاختيار. ستُرفع الصورة ثم يُحفظ رابطها تلقائيًا.</small>
              <div style="display: flex; justify-content: center;">
                <img id="work_image_preview" alt="معاينة الصورة" class="image-preview" />
              </div>
              <div id="workImageActions" class="image-actions" style="display:none">
                <button type="button" class="btn btn-outline" id="work_edit_image_btn"><i class="fa-regular fa-pen-to-square"></i> تعديل الصورة</button>
                <button type="button" class="btn btn-outline" id="work_change_image_btn"><i class="fa-regular fa-image"></i> تغيير الصورة</button>
              </div>
            </label>
            <label>رابط خارجي<input name="link" class="link" type="url" placeholder="https://..." /></label>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary">حفظ</button>
        </menu>
      </form>
    </dialog>

    <dialog id="sponsorDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="sponsorForm">
        <div class="dialog-header">
          <h3 class="dialog-title">إضافة/تعديل راعٍ</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid">
            <label>الاسم<input name="name" required /></label>
            <label>الوسم<input name="badge" placeholder="راعي تعليمي.." /></label>
            <label>الوصف<textarea name="description" rows="3" placeholder="نص قصير يظهر في كارد الراعي"></textarea></label>
            <label>شعار الراعي
              <div id="sponsorDropzone" class="upload-dropzone" tabindex="0" role="button" aria-label="رفع الشعار بالضغط أو السحب والإفلات">
                <i class="fa-regular fa-image" aria-hidden="true"></i>
                <div class="dz-text">
                  <strong>اسحب وأفلت الشعار هنا</strong>
                  <span id="sponsorBrowseBtn">أو اضغط لاختيار الشعار من جهازك</span>
                </div>
              </div>
              <input id="sponsor_logo_file" type="file" accept="image/*" style="display:none" />
              <input id="sponsor_logo_url" name="logo_url" type="hidden" />
              <small class="field-help">يدعم PNG وWEBP. سيتم رفع الشعار وحفظ رابطه تلقائيًا.</small>
              <div style="display: flex; justify-content: center;">
                <img id="sponsor_logo_preview" alt="معاينة الشعار" class="image-preview" />
              </div>
              <div id="sponsorImageActions" class="image-actions" style="display:none">
                <button type="button" class="btn btn-outline" id="sponsor_edit_logo_btn"><i class="fa-regular fa-pen-to-square"></i> تعديل الشعار</button>
                <button type="button" class="btn btn-outline" id="sponsor_change_logo_btn"><i class="fa-regular fa-image"></i> تغيير الشعار</button>
              </div>
            </label>
            <label>رابط الموقع<input name="link" type="url" /></label>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary">حفظ</button>
        </menu>
      </form>
    </dialog>

    <dialog id="achievementDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="achievementForm">
        <div class="dialog-header">
          <h3 class="dialog-title">إضافة/تعديل إنجاز</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid">
            <label>النص الظاهر تحت الرقم<input name="label" required placeholder="مثل: ورش تدريبية" /></label>
            <label>أيقونة Font Awesome<input name="icon" placeholder="مثال: fa-solid fa-trophy" /></label>
            <label>العدد<input name="count" type="number" min="0" required placeholder="0" /></label>
            <label style="display:flex;align-items:center;gap:8px"><input name="plus" type="checkbox" checked /> إظهار علامة + بجانب الرقم</label>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary">حفظ</button>
        </menu>
      </form>
    </dialog>

    <dialog id="boardDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="boardForm">
        <div class="dialog-header">
          <h3 class="dialog-title">إضافة/تعديل عضو</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid">
            <label>الاسم<input name="name" required /></label>
            <label>المنصب<input name="position" required /></label>
            <label>صورة العضو
              <div id="boardDropzone" class="upload-dropzone" tabindex="0" role="button" aria-label="رفع صورة العضو بالضغط أو السحب والإفلات">
                <i class="fa-regular fa-image" aria-hidden="true"></i>
                <div class="dz-text">
                  <strong>اسحب وأفلت الصورة هنا</strong>
                  <span id="boardBrowseBtn">أو اضغط لاختيار الصورة من جهازك</span>
                </div>
              </div>
              <input id="board_image_file" type="file" accept="image/*" style="display:none" />
              <input id="board_image_url" name="image_url" type="hidden" />
              <small class="field-help">سيتم فتح أداة القص بنسبة 1:1 وحفظ الرابط تلقائيًا بعد الرفع.</small>
              <div style="display: flex; justify-content: center;">
                <img id="board_image_preview" alt="معاينة الصورة" class="image-preview" />
              </div>
              <div id="boardImageActions" class="image-actions" style="display:none">
                <button type="button" class="btn btn-outline" id="board_edit_image_btn"><i class="fa-regular fa-pen-to-square"></i> تعديل الصورة</button>
                <button type="button" class="btn btn-outline" id="board_change_image_btn"><i class="fa-regular fa-image"></i> تغيير الصورة</button>
              </div>
            </label>
            <label>تويتر<input name="twitter" type="url" /></label>
            <label>لينكدإن<input name="linkedin" type="url" /></label>
            <label>البريد<input name="email" type="email" /></label>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary">حفظ</button>
        </menu>
      </form>
    </dialog>

    <dialog id="faqDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="faqForm">
        <div class="dialog-header">
          <h3 class="dialog-title">إضافة/تعديل سؤال</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid">
            <label>السؤال<input name="question" required /></label>
            <label>الإجابة<textarea name="answer" rows="4" required placeholder="اكتب الإجابة هنا..."></textarea></label>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary">حفظ</button>
        </menu>
      </form>
    </dialog>

    <dialog id="testimonialDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="testimonialForm">
        <div class="dialog-header">
          <h3 class="dialog-title">إضافة/تعديل رأي عضو</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid">
            <label>الاسم<input name="member_name" required placeholder="اسم العضو" /></label>
            <label>اللجنة
              <select name="committee">
                <option value="">اختر اللجنة</option>
                <option>لجنة التأليف</option>
                <option>لجنة الرواة</option>
                <option>لجنة التصميم</option>
                <option>لجنة الفعاليات</option>
                <option>لجنة السفراء</option>
                <option>لجنة الإنتاج</option>
                <option>المجلس الإداري</option>
              </select>
            </label>
            <label>التقييم
              <select name="rating" required>
                <option value="5">5</option>
                <option value="4">4</option>
                <option value="3">3</option>
                <option value="2">2</option>
                <option value="1">1</option>
              </select>
            </label>
            <label>نص الرأي<textarea name="text" rows="4" required placeholder="اكتب الرأي..."></textarea></label>
            <label style="display:flex;align-items:center;gap:8px"><input name="visible" type="checkbox" checked /> ظاهر للجميع</label>

            <label>صورة العضو (اختياري)
              <div id="testimonialDropzone" class="upload-dropzone" tabindex="0" role="button" aria-label="رفع الصورة بالضغط أو السحب والإفلات">
                <i class="fa-regular fa-image" aria-hidden="true"></i>
                <div class="dz-text">
                  <strong>اسحب وأفلت الصورة هنا</strong>
                  <span id="testimonialBrowseBtn">أو اضغط لاختيار الصورة من جهازك</span>
                </div>
              </div>
              <input id="testimonial_image_file" type="file" accept="image/*" style="display:none" />
              <input id="testimonial_image_url" name="avatar_url" type="hidden" />
              <div style="display:flex;justify-content:center;">
                <img id="testimonial_image_preview" alt="معاينة الصورة" class="image-preview" />
              </div>
              <div id="testimonialImageActions" class="image-actions" style="display:none">
                <button type="button" class="btn btn-outline" id="testimonial_edit_image_btn"><i class="fa-regular fa-pen-to-square"></i> تعديل الصورة</button>
                <button type="button" class="btn btn-outline" id="testimonial_change_image_btn"><i class="fa-regular fa-image"></i> تغيير الصورة</button>
              </div>
            </label>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary">حفظ</button>
        </menu>
      </form>
    </dialog>

    <dialog id="todoDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="todoForm">
        <div class="dialog-header">
          <h3 class="dialog-title"><i class="fa-solid fa-list-check"></i> إضافة/تعديل مهمة</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid">
            <label>العنوان<input name="title" required placeholder="عنوان المهمة" /></label>
            <label>تاريخ الاستحقاق<input name="due" type="date" /></label>
            <label>الحالة
              <select name="status">
                <option value="pending">قيد الانتظار</option>
                <option value="in_progress">قيد التنفيذ</option>
                <option value="done">منجزة</option>
              </select>
            </label>
            <label>ملاحظات<textarea name="notes" rows="4" placeholder="تفاصيل إضافية"></textarea></label>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary"><i class="fa-regular fa-floppy-disk"></i> حفظ</button>
        </menu>
      </form>
    </dialog>

    <dialog id="appointmentDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="appointmentForm">
        <div class="dialog-header">
          <h3 class="dialog-title"><i class="fa-solid fa-calendar-check"></i> إضافة/تعديل موعد</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid" style="grid-template-columns: 1fr">
            <label>العنوان<input name="title" required placeholder="عنوان الموعد" /></label>
          </div>
          <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
            <button type="button" class="btn btn-outline" id="addSlotBtn"><i class="fa-solid fa-plus"></i> إضافة وقت</button>
          </div>
          <div id="appointmentSlots" class="form-grid" style="margin-top:8px"></div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary"><i class="fa-regular fa-floppy-disk"></i> حفظ</button>
        </menu>
      </form>
    </dialog>

    <dialog id="blogDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="blogForm">
        <div class="dialog-header">
          <h3 class="dialog-title">إضافة/تعديل تدوينة</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="form-grid">
            <label>العنوان<input name="title" required /></label>
            <label>صورة الغلاف (رابط)<input name="image" type="url" placeholder="https://..." /></label>
            <label>الكاتب<input name="author" placeholder="اسم الكاتب" /></label>
            <label>تاريخ النشر<input name="published_at" type="date" /></label>
            <label>حالة النشر
              <select name="status">
                <option value="published">منشور</option>
                <option value="draft">مسودة</option>
              </select>
            </label>
            <label>التصنيفات<input name="categories" placeholder="مثال: أدب، مبادرات، شعر" /></label>
            <label>مقتطف قصير<textarea name="excerpt" rows="3" placeholder="نبذة مختصرة"></textarea></label>
            <label>المحتوى الكامل<textarea name="content" rows="6" placeholder="نص التدوينة"></textarea></label>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit" class="btn btn-primary">حفظ</button>
        </menu>
      </form>
    </dialog>

    <dialog id="scheduleDayDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form" id="scheduleDayForm">
        <div class="dialog-header">
          <h3 class="dialog-title"><i class="fa-solid fa-calendar-day"></i> محتوى يوم <span id="scheduleSelectedDate"></span></h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div class="day-items-section">
            <div class="form-grid">
              <label>العنوان
                <input id="dayItemTitle" name="day_item_title" placeholder="عنوان قصير" />
              </label>
              <label>الملاحظات
                <textarea id="dayItemNotes" name="day_item_notes" rows="4" placeholder="تفاصيل أو وصف" ></textarea>
              </label>
            </div>
            <div style="display:flex; gap:8px; align-items:center; margin:8px 0 12px">
              <button type="button" class="btn btn-primary" id="dayAddBtn"><i class="fa-solid fa-plus"></i> إضافة</button>
              <button type="button" class="btn" id="dayCancelEditBtn" style="display:none"><i class="fa-solid fa-rotate-left"></i> إلغاء التعديل</button>
              <div class="muted" id="dayEditState" style="display:none">وضع تعديل عنصر</div>
            </div>
            <div class="day-items-list" id="dayItemsList" aria-live="polite"></div>
            <small class="field-help">يمكنك إضافة عدة عناصر لليوم نفسه. استخدم حفظ لحفظ جميع التغييرات.</small>
          </div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn" id="dayDeleteBtn"><i class="fa-solid fa-trash"></i> حذف اليوم</button>
          <div style="flex:1"></div>
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إلغاء</button>
          <button value="submit " class="btn btn-primary"><i class="fa-regular fa-floppy-disk"></i> حفظ</button>
        </menu>
      </form>
    </dialog>

    <!-- Admin Details Dialog -->
    <dialog id="adminDetailsDialog" class="admin-dialog">
      <form method="dialog" class="dialog-form">
        <div class="dialog-header">
          <h3 class="dialog-title"><i class="fa-regular fa-id-card"></i> تفاصيل الإداري</h3>
          <button type="button" class="dialog-close" aria-label="إغلاق" onclick="this.closest('dialog').close()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="dialog-body">
          <div id="adminDetailsBody" style="display:grid; gap:12px"></div>
        </div>
        <menu class="dialog-actions">
          <button type="button" class="btn btn-outline" id="adminRemoveBtn"><i class="fa-solid fa-user-slash"></i> حذف من الإداريين</button>
          <div style="flex:1"></div>
          <button type="button" class="btn" onclick="this.closest('dialog').close()">إغلاق</button>
        </menu>
      </form>
    </dialog>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/cropperjs@1.6.2/dist/cropper.min.js"></script>
    <script src="../supabase-config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      (async () => {
        const VERIFIED_KEY = 'adeeb_admin_verified_ts';
        const wasVerifiedRecently = (days = 30) => {
          try { const ts = Number(localStorage.getItem(VERIFIED_KEY) || 0); return (Date.now() - ts) < days * 864e5; } catch { return false; }
        };
        const markVerifiedNow = () => { try { localStorage.setItem(VERIFIED_KEY, String(Date.now())); } catch {} };
        const redirectToLogin = () => {
          const url = new URL('../login.html', location.href);
          url.searchParams.set('redirect', 'admin/admin.html');
          location.replace(url.toString());
        };
        const sb = window.sbClient;
        if (!sb) { redirectToLogin(); return; }
        try {
          const { data: { session } } = await sb.auth.getSession();
          if (!session) { redirectToLogin(); return; }
          // Role check: only allow admins
          const userId = session.user?.id;
          if (!userId) { redirectToLogin(); return; }
          const { data: adminRow, error: adminErr } = await sb
            .from('admins')
            .select('user_id,is_admin')
            .eq('user_id', userId)
            .eq('is_admin', true)
            .maybeSingle();
          if (adminErr || !adminRow) {
            // Offline fallback: if previously verified and currently offline, allow opening the shell
            if (!navigator.onLine && wasVerifiedRecently()) {
              document.body.style.display = '';
              try { if ('serviceWorker' in navigator) { await navigator.serviceWorker.register('./sw.js', { scope: './' }); } } catch {}
              return;
            }
            // Logged-in but not admin -> show inline access denied and stop
            document.body.style.display = '';
            document.body.innerHTML = `
              <div style="min-height:100dvh;display:flex;align-items:center;justify-content:center;padding:24px;background:#f8fafc">
                <div style="max-width:560px;width:100%;background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:24px;text-align:center;box-shadow:0 10px 24px rgba(0,0,0,.06)">
                  <div style="font-size:40px;color:#ef4444;margin-bottom:8px"><i class="fa-solid fa-ban"></i></div>
                  <h1 style="margin:0 0 8px;font-size:22px">لا تملك صلاحية دخول لوحة التحكم</h1>
                  <p style="margin:0 0 16px;color:#64748b;line-height:1.7">يمكنك استخدام حساب إداري، أو الرجوع للموقع أو إلى صفحة تسجيل الدخول.</p>
                  <div style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap">
                    <a class="btn btn-outline" href="../index.html"><i class="fa-solid fa-globe"></i> الرجوع للموقع</a>
                    <a class="btn btn-primary" href="../login.html?redirect=admin/admin.html"><i class="fa-solid fa-right-to-bracket"></i> تبديل الحساب</a>
                  </div>
                </div>
              </div>
            `;
            return;
          }
          // Mark success to enable offline opening later
          markVerifiedNow();
        } catch (e) {
          // If offline and recently verified, allow opening the shell for limited offline use
          try {
            const { data: { session } } = await sb.auth.getSession();
            if (!navigator.onLine && session && wasVerifiedRecently()) {
              document.body.style.display = '';
              try { if ('serviceWorker' in navigator) { await navigator.serviceWorker.register('./sw.js', { scope: './' }); } } catch {}
              return;
            }
          } catch {}
          redirectToLogin(); return;
        }
        // Admin verified -> reveal UI
        document.body.style.display = '';
        // Register service worker (PWA) after access is verified
        try {
          if ('serviceWorker' in navigator) {
            await navigator.serviceWorker.register('./sw.js', { scope: './' });
          }
        } catch (e) { console.warn('SW registration failed', e); }
      })();
    </script>
    <script src="admin.js?v=20251011"></script>
  </body>
</html>
