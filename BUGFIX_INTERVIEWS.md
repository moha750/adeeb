# ุฅุตูุงุญ ูุดููุฉ ูุธุงู ุงูููุงุจูุงุช

## ๐ ุงููุดููุฉ ุงูููุชุดูุฉ

ุนูุฏ ูุจูู ุทูุจ ููููุงุจูุฉ ูู ูุณู "ูุฑุงุฌุนุฉ ุงูุทูุจุงุช"ุ ูุงู ุงููุธุงู:
- โ ูุญุฏุซ ุญุงูุฉ ุงูุทูุจ ุฅูู `approved_for_interview`
- โ **ูุง ููุดุฆ ุณุฌู ูู ุฌุฏูู `membership_interviews`**
- โ ูุง ูุธูุฑ ุดูุก ูู ูุณู ุงูููุงุจูุงุช

### ุงูุณุจุจ ุงูุฌุฐุฑู:
ุฏุงูุฉ `approveForInterview()` ูุงูุช ุชููู ููุท ุจุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ ุฏูู ุฅูุดุงุก ุณุฌู ููุงุจูุฉ.

---

## โ ุงูุญู ุงูููุทุจู

### **1. ุชุญุฏูุซ ุฏุงูุฉ `approveForInterview()`**

**ูุจู ุงูุฅุตูุงุญ:**
```javascript
async function approveForInterview(applicationId) {
    // ูุงูุช ุชุญุฏุซ ุงูุญุงูุฉ ููุท
    await window.sbClient
        .from('membership_applications')
        .update({ status: 'approved_for_interview' })
        .eq('id', applicationId);
}
```

**ุจุนุฏ ุงูุฅุตูุงุญ:**
```javascript
async function approveForInterview(applicationId) {
    // 1. ุณุคุงู ุงููุณุชุฎุฏู: ูู ูุฑูุฏ ุฌุฏููุฉ ุงูุขูุ
    const { value: scheduleNow } = await Swal.fire({
        title: 'ูุจูู ููููุงุจูุฉ',
        text: 'ูู ุชุฑูุฏ ุฌุฏููุฉ ุงูููุงุจูุฉ ุงูุขูุ',
        showDenyButton: true,
        confirmButtonText: 'ูุนูุ ุฌุฏููุฉ ุงูุขู',
        denyButtonText: 'ูุงุ ุณุฃุฌุฏูููุง ูุงุญูุงู'
    });

    // 2. ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ
    await updateApplicationStatus(applicationId);

    // 3. ุฅุฐุง ุงุฎุชุงุฑ ุฌุฏููุฉ ุงูุขูุ ููุดุฆ ุณุฌู ููุงุจูุฉ
    if (scheduleNow) {
        await scheduleInterviewForApplication(applicationId, application);
    }
}
```

### **2. ุฅุถุงูุฉ ุฏุงูุฉ `scheduleInterviewForApplication()`**

ุฏุงูุฉ ุฌุฏูุฏุฉ ุชููู ุจู:
- ุนุฑุถ ูููุฐุฌ ุฌุฏููุฉ ุงูููุงุจูุฉ
- ุฅูุดุงุก ุณุฌู ูู ุฌุฏูู `membership_interviews`
- ุฑุจุท ุงูููุงุจูุฉ ุจุงูุทูุจ

```javascript
async function scheduleInterviewForApplication(applicationId, application) {
    // ุนุฑุถ ูููุฐุฌ ุงูุฌุฏููุฉ
    const formValues = await showScheduleForm(application);
    
    // ุฅูุดุงุก ุณุฌู ุงูููุงุจูุฉ
    await window.sbClient
        .from('membership_interviews')
        .insert({
            application_id: applicationId,
            interview_date: formValues.date,
            interview_type: formValues.type,
            interview_location: formValues.location,
            status: 'scheduled',
            result: 'pending'
        });
}
```

### **3. ุฅุตูุงุญ ุฏุงูุฉ `scheduleNewInterview()`**

**ุงููุดููุฉ:**
ูุงูุช ุชุณุชุฎุฏู ุงุณุชุนูุงู ุบูุฑ ุตุญูุญ:
```javascript
.is('id', 'not.in.(select application_id from membership_interviews)')
// โ ูุง ูุนูู ูู Supabase
```

**ุงูุญู:**
```javascript
// 1. ุฌูุจ ุฌููุน ุงูุทูุจุงุช ุงูููุจููุฉ
const { data: applications } = await window.sbClient
    .from('membership_applications')
    .select('id, full_name, email, preferred_committee')
    .eq('status', 'approved_for_interview');

// 2. ุฌูุจ ุงูููุงุจูุงุช ุงูููุฌูุฏุฉ
const { data: existingInterviews } = await window.sbClient
    .from('membership_interviews')
    .select('application_id');

// 3. ููุชุฑุฉ ุงูุทูุจุงุช ูุฏููุงู
const existingAppIds = new Set(existingInterviews.map(i => i.application_id));
const availableApps = applications.filter(app => !existingAppIds.has(app.id));
```

---

## ๐ ุณูุฑ ุงูุนูู ุงูุฌุฏูุฏ

### **ุงูุณููุงุฑูู 1: ุฌุฏููุฉ ููุฑูุฉ**
```
1. ุงููุณุชุฎุฏู ูุถุบุท "ูุจูู ููููุงุจูุฉ"
   โ
2. ูุธูุฑ ุณุคุงู: "ูู ุชุฑูุฏ ุฌุฏููุฉ ุงูููุงุจูุฉ ุงูุขูุ"
   โ
3. ูุฎุชุงุฑ "ูุนูุ ุฌุฏููุฉ ุงูุขู"
   โ
4. ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ โ approved_for_interview
   โ
5. ุนุฑุถ ูููุฐุฌ ุงูุฌุฏููุฉ (ุชุงุฑูุฎุ ููุนุ ูููุน)
   โ
6. ุฅูุดุงุก ุณุฌู ูู membership_interviews
   โ
7. โ ูุธูุฑ ูู ูุณู ุงูููุงุจูุงุช ูุจุงุดุฑุฉ
```

### **ุงูุณููุงุฑูู 2: ุฌุฏููุฉ ูุงุญูุฉ**
```
1. ุงููุณุชุฎุฏู ูุถุบุท "ูุจูู ููููุงุจูุฉ"
   โ
2. ูุธูุฑ ุณุคุงู: "ูู ุชุฑูุฏ ุฌุฏููุฉ ุงูููุงุจูุฉ ุงูุขูุ"
   โ
3. ูุฎุชุงุฑ "ูุงุ ุณุฃุฌุฏูููุง ูุงุญูุงู"
   โ
4. ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ โ approved_for_interview
   โ
5. ุฑุณุงูุฉ: "ุชู ูุจูู ุงูุทูุจ. ููููู ุฌุฏููุฉ ุงูููุงุจูุฉ ูู ูุณู ุงูููุงุจูุงุช"
   โ
6. ุงููุณุชุฎุฏู ูุฐูุจ ุฅูู ูุณู "ุงูููุงุจูุงุช"
   โ
7. ูุถุบุท "ุฌุฏููุฉ ููุงุจูุฉ ุฌุฏูุฏุฉ"
   โ
8. ูุฎุชุงุฑ ุงููุชูุฏู ูู ุงููุงุฆูุฉ
   โ
9. โ ูุธูุฑ ูู ูุณู ุงูููุงุจูุงุช
```

---

## ๐ ุงูุชุบููุฑุงุช ูู ุงูููุฏ

### **ุงููููุงุช ุงูููุนุฏููุฉ:**

#### `admin/js/membership-manager.js`

**1. ุฏุงูุฉ `approveForInterview()` - ุงูุณุทูุฑ 954-1008:**
- ุฅุถุงูุฉ ุณุคุงู ูููุณุชุฎุฏู
- ุฎูุงุฑ ุฌุฏููุฉ ููุฑูุฉ ุฃู ูุงุญูุฉ
- ุงุณุชุฏุนุงุก `scheduleInterviewForApplication()` ุฅุฐุง ุงุฎุชุงุฑ ุงูุฌุฏููุฉ ุงูุขู

**2. ุฏุงูุฉ `scheduleInterviewForApplication()` - ุงูุณุทูุฑ 1010-1086 (ุฌุฏูุฏุฉ):**
- ุนุฑุถ ูููุฐุฌ ุฌุฏููุฉ ุงูููุงุจูุฉ
- ุฅูุดุงุก ุณุฌู ูู `membership_interviews`
- ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

**3. ุฏุงูุฉ `scheduleNewInterview()` - ุงูุณุทูุฑ 2010-2109:**
- ุฅุตูุงุญ ุงูุงุณุชุนูุงู ูุงุณุชุซูุงุก ุงูุทูุจุงุช ุงูุชู ููุง ููุงุจูุงุช
- ุงุณุชุฎุฏุงู ููุชุฑุฉ JavaScript ุจุฏูุงู ูู SQL subquery

---

## โ ุงูุงุฎุชุจุงุฑ

### **ุงุฎุชุจุงุฑ ุงูุณููุงุฑูู 1 (ุฌุฏููุฉ ููุฑูุฉ):**
```
1. ุงูุชุญ "ูุฑุงุฌุนุฉ ุงูุทูุจุงุช"
2. ุงุถุบุท "ุนุฑุถ" ุนูู ุทูุจ ุฌุฏูุฏ
3. ุงุถุบุท "ูุจูู ููููุงุจูุฉ"
4. ุงุฎุชุฑ "ูุนูุ ุฌุฏููุฉ ุงูุขู"
5. ุงููุฃ ุชูุงุตูู ุงูููุงุจูุฉ
6. ุชุญูู ูู ุธููุฑ ุงูููุงุจูุฉ ูู ูุณู "ุงูููุงุจูุงุช"
```

### **ุงุฎุชุจุงุฑ ุงูุณููุงุฑูู 2 (ุฌุฏููุฉ ูุงุญูุฉ):**
```
1. ุงูุชุญ "ูุฑุงุฌุนุฉ ุงูุทูุจุงุช"
2. ุงุถุบุท "ุนุฑุถ" ุนูู ุทูุจ ุฌุฏูุฏ
3. ุงุถุบุท "ูุจูู ููููุงุจูุฉ"
4. ุงุฎุชุฑ "ูุงุ ุณุฃุฌุฏูููุง ูุงุญูุงู"
5. ุงูุชุญ ูุณู "ุงูููุงุจูุงุช"
6. ุงุถุบุท "ุฌุฏููุฉ ููุงุจูุฉ ุฌุฏูุฏุฉ"
7. ุงุฎุชุฑ ุงููุชูุฏู ูู ุงููุงุฆูุฉ
8. ุงููุฃ ุงูุชูุงุตูู
9. ุชุญูู ูู ุธููุฑ ุงูููุงุจูุฉ
```

---

## ๐ฏ ุงูููุงุฆุฏ

1. โ **ูุฑููุฉ ุฃูุจุฑ:** ุงููุณุชุฎุฏู ูุฎุชุงุฑ ูุชู ูุฌุฏูู ุงูููุงุจูุฉ
2. โ **ุณูุฑ ุนูู ูุงุถุญ:** ุฎุทูุงุช ููุทููุฉ ููุชุณูุณูุฉ
3. โ **ูุง ููุฏุงู ุจูุงูุงุช:** ูู ุทูุจ ููุจูู ูููู ุฌุฏููุฉ ููุงุจูุฉ ูู
4. โ **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู:** ุฎูุงุฑุงุช ูุงุถุญุฉ ูุฑุณุงุฆู ูููุฏุฉ
5. โ **ููุฏ ูุธูู:** ูุตู ุงููุณุคูููุงุช ุจูู ุงูุฏูุงู

---

## ๐ ููุงุท ุงูุชุญูู

- [x] ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ ูุนูู ุจุดูู ุตุญูุญ
- [x] ุฅูุดุงุก ุณุฌู ุงูููุงุจูุฉ ูุนูู
- [x] ุงูููุงุจูุงุช ุชุธูุฑ ูู ูุณู ุงูููุงุจูุงุช
- [x] ููุชุฑุฉ ุงูุทูุจุงุช ูู `scheduleNewInterview` ุชุนูู
- [x] ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ููุฌูุฏุฉ
- [x] ุฑุณุงุฆู ุงููุณุชุฎุฏู ูุงุถุญุฉ

---

## ๐ ููุงุญุธุงุช ุฅุถุงููุฉ

### **ููุงุฐุง ูุง ูุชู ุฅูุดุงุก ุงูููุงุจูุฉ ุชููุงุฆูุงูุ**
ูุฃู ุงูููุงุจูุฉ ุชุญุชุงุฌ ุฅูู:
- ุชุงุฑูุฎ ูููุช ูุญุฏุฏ
- ููุน ุงูููุงุจูุฉ (ุญุถูุฑู/ุฃูููุงูู/ูุงุชูู)
- ูููุน ุฃู ุฑุงุจุท

ูุฐู ุงููุนูููุงุช ูุง ูููู ุชูููุฏูุง ุชููุงุฆูุงูุ ูุฐุง ูุนุทู ุงููุณุชุฎุฏู ุฎูุงุฑ:
1. ุฅุฏุฎุงููุง ุงูุขู (ุฌุฏููุฉ ููุฑูุฉ)
2. ุฅุฏุฎุงููุง ูุงุญูุงู (ูู ูุณู ุงูููุงุจูุงุช)

### **ุงูุชูุงูู ูุน ุงููุธุงู ุงูุณุงุจู:**
- ุฌููุน ุงูุทูุจุงุช ุงููุฏููุฉ ุจุญุงูุฉ `approved_for_interview` ูููู ุฌุฏููุฉ ููุงุจูุงุช ููุง
- ูุง ุญุงุฌุฉ ูุชุญุฏูุซ ุงูุจูุงูุงุช ุงููุฏููุฉ
- ุงููุธุงู ูุนูู ุจุณูุงุณุฉ ูุน ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ

---

## โจ ุงูุฎูุงุตุฉ

ุชู ุฅุตูุงุญ ุงููุดููุฉ ุจุดูู **ุฌุฐุฑู ูุตุงุฑู** ูู ุฎูุงู:
1. โ ุฅุถุงูุฉ ุฎูุงุฑ ุฌุฏููุฉ ููุฑูุฉ ุนูุฏ ุงููุจูู
2. โ ุฅุตูุงุญ ุงุณุชุนูุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. โ ูุตู ุงููุณุคูููุงุช ุจูู ุงูุฏูุงู
4. โ ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

**ุงููุธุงู ุงูุขู ูุนูู ุจุดูู ูุงูู ููุชูุงูู!** ๐
